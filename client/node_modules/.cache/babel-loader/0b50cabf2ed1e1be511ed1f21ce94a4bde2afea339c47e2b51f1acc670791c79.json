{"ast":null,"code":"import _regeneratorRuntime from \"/home/user/School/CSC330/ThinkLink/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _objectSpread from \"/home/user/School/CSC330/ThinkLink/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _asyncToGenerator from \"/home/user/School/CSC330/ThinkLink/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport { ref } from 'vue';\nimport { quillEditor } from 'vue3-quill';\nimport savebuttoncontainer from '../components/savebuttoncontainer';\nimport { jsPDF } from 'jspdf';\nimport axios from 'axios';\nimport pdfMake from 'pdfmake/build/pdfmake';\nimport pdfFonts from 'pdfmake/build/vfs_fonts';\npdfMake.vfs = pdfFonts.pdfMake.vfs;\nexport default {\n  name: 'Drafts',\n  components: {\n    savebuttoncontainer: savebuttoncontainer,\n    quillEditor: quillEditor\n  },\n  props: {\n    project_id: {\n      type: String,\n      required: true\n    }\n  },\n  data: function data() {\n    return {\n      draftName: '',\n      quill: null,\n      project_id: this.project_id,\n      editorContent: ''\n    };\n  },\n  methods: {\n    onEditorReady: function onEditorReady(editor) {\n      this.quill = editor;\n    },\n    save: function save() {\n      var _this = this;\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var delta, content, docDefinition, pdfDocGenerator, pdfDataUrl, blobResponse, blob, formData, postResponse;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              if (!_this.quill) {\n                _context.next = 28;\n                break;\n              }\n              delta = _this.quill.getContents();\n              content = delta.ops.map(function (op) {\n                if (op.insert) {\n                  if (typeof op.insert === 'string') {\n                    return _objectSpread({\n                      text: op.insert\n                    }, op.attributes);\n                  } else if (op.insert.image) {\n                    return {\n                      image: op.insert.image\n                    };\n                  }\n                }\n                return {};\n              });\n              docDefinition = {\n                content: content\n              };\n              _context.prev = 4;\n              pdfDocGenerator = pdfMake.createPdf(docDefinition);\n              _context.next = 8;\n              return new Promise(function (resolve, reject) {\n                pdfDocGenerator.getDataUrl(function (dataUrl) {\n                  resolve(dataUrl);\n                });\n              });\n            case 8:\n              pdfDataUrl = _context.sent;\n              _context.next = 11;\n              return fetch(pdfDataUrl);\n            case 11:\n              blobResponse = _context.sent;\n              _context.next = 14;\n              return response.blob();\n            case 14:\n              blob = _context.sent;\n              formData = new FormData();\n              formData.append('action', 'create_draft');\n              formData.append('file', blob, \"\".concat(_this.draftName, \".pdf\"));\n              formData.append('file_data', JSON.stringify({\n                content: _this.quill.getText(),\n                filename: \"\".concat(_this.draftName, \".pdf\")\n              }));\n              _context.next = 21;\n              return axios.post(\"\".concat(process.env.VUE_APP_FLASK_APP_URL, \"/project_workspace/\").concat(_this.project_id), formData, {\n                headers: {\n                  'Content-Type': 'multipart/form-data'\n                }\n              });\n            case 21:\n              postResponse = _context.sent;\n              if (response.status === 200) {\n                console.log('Draft saved successfully');\n              } else {\n                console.log('Failed to save draft');\n              }\n              _context.next = 28;\n              break;\n            case 25:\n              _context.prev = 25;\n              _context.t0 = _context[\"catch\"](4);\n              console.error('An error occurred while saving the draft:', _context.t0);\n            case 28:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[4, 25]]);\n      }))();\n    }\n  }\n};","map":{"version":3,"names":["ref","quillEditor","savebuttoncontainer","jsPDF","axios","pdfMake","pdfFonts","vfs","name","components","props","project_id","type","String","required","data","draftName","quill","editorContent","methods","onEditorReady","editor","save","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","delta","content","docDefinition","pdfDocGenerator","pdfDataUrl","blobResponse","blob","formData","postResponse","wrap","_callee$","_context","prev","next","getContents","ops","map","op","insert","_objectSpread","text","attributes","image","createPdf","Promise","resolve","reject","getDataUrl","dataUrl","sent","fetch","response","FormData","append","concat","JSON","stringify","getText","filename","post","process","env","VUE_APP_FLASK_APP_URL","headers","status","console","log","t0","error","stop"],"sources":["/home/user/School/CSC330/ThinkLink/client/src/components/drafts.vue"],"sourcesContent":["/<!--\n<template>\n    <input class=\"draft-name-input\" v-model=\"draftName\" placeholder=\"Enter draft name\" />\n    <div v-html=\"compiledMarkdown\" class=\"markdown-preview\"></div>\n    <textarea id=\"markdown-editor\" v-model=\"markdown\"></textarea>\n    <savebuttoncontainer class=\"save-button\" @click=\"save\"></savebuttoncontainer>\n</template>\n-->\n<template>\n    <input class=\"draft-name-input\" v-model=\"draftName\" placeholder=\"Enter draft name\" />\n    <!--<div v-html=\"compiledMarkdown \" class=\"markdown-preview\"></div>-->\n    <quill-editor @ready=\"onEditorReady\" ref=\"quill\" id=\"quill-editor\" editorContent=\"quill\" ></quill-editor>\n    <savebuttoncontainer class=\"save-button\" @click=\"save\"></savebuttoncontainer>\n</template>\n  \n<script>\nimport { ref } from 'vue';\nimport { quillEditor } from 'vue3-quill';\nimport savebuttoncontainer from '../components/savebuttoncontainer';\nimport { jsPDF } from 'jspdf';\nimport axios from 'axios';\nimport pdfMake from 'pdfmake/build/pdfmake';\nimport pdfFonts from 'pdfmake/build/vfs_fonts';\npdfMake.vfs = pdfFonts.pdfMake.vfs;\n\nexport default {\n    name: 'Drafts',\n    components: {\n        savebuttoncontainer,\n        quillEditor\n    },\n    props: {\n        project_id: {\n        type: String,\n        required: true,\n        },\n    },\n    data() {\n        return {\n            draftName: '',\n            quill: null,\n            project_id: this.project_id,\n            editorContent: ''\n        };\n    },\n    methods: {\n        onEditorReady(editor) {\n            this.quill = editor;\n        },\n        async save() {\n            if (this.quill) {\n                const delta = this.quill.getContents();\n\n                const content = delta.ops.map(op => {\n                    if (op.insert) {\n                        if (typeof op.insert === 'string') {\n                            return { text: op.insert, ...op.attributes };\n                        } else if (op.insert.image) {\n                            return { image: op.insert.image };\n                        }\n                    }\n                    return {};\n                });\n\n                const docDefinition = { content };\n\n                try {\n                    const pdfDocGenerator = pdfMake.createPdf(docDefinition);\n                    const pdfDataUrl = await new Promise((resolve, reject) => {\n                        pdfDocGenerator.getDataUrl((dataUrl) => {\n                            resolve(dataUrl);\n                        });\n                    });\n\n                    // Convert data URL to blob\n                    const blobResponse = await fetch(pdfDataUrl);\n                    const blob = await response.blob();\n\n                    const formData = new FormData();\n                    formData.append('action', 'create_draft');\n                    formData.append('file', blob, `${this.draftName}.pdf`);\n                    formData.append('file_data', JSON.stringify({\n                        content: this.quill.getText(),\n                        filename: `${this.draftName}.pdf`\n                    }));\n\n                    const postResponse = await axios.post(`${process.env.VUE_APP_FLASK_APP_URL}/project_workspace/${this.project_id}`, formData, {\n                        headers: {\n                            'Content-Type': 'multipart/form-data'\n                        }\n                    });\n\n                    if (response.status === 200) {\n                        console.log('Draft saved successfully');\n                    } else {\n                        console.log('Failed to save draft');\n                    }\n                } catch (error) {\n                    console.error('An error occurred while saving the draft:', error);\n                }\n            }\n        }\n    }\n};\n</script>\n\n<style scoped>\n.projectworkspace-pagemain {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-items: center;\n  justify-content: center;\n  padding-top: 30px;\n  max-width: 100%;\n  height: 100%;\n  position: relative;\n  flex-grow: 1;\n}\n\n#quill-editor {\n  display: flex;\n  width: 500px;\n  height: 450px;\n  border: 1px solid black;\n}\n\n.draft-name-input {\n  height: 55px;\n  padding: 10px;\n  font-size: 30px;\n  margin-bottom: 20px;\n  border: 2px solid black;\n  border-radius: 4px;\n  align-items: center;\n  justify-content: center;\n}\n/*\n.markdown-preview {\n  margin-top: 10px;\n  margin-bottom: 10px;\n  overflow-y: auto;\n  height: 200px;\n  width: 500px;\n  border: 1px solid black;\n}\n*/\n.save-button {\n  align-self: center;\n}\n</style>\n<!--\n/*\nconst compiledMarkdown = computed(() => {\n    return md.render(markdown.value);\n});\n\nconst save = async () => {\n    const doc = new jsPDF();\n    doc.text(markdown.value, 10, 10);\n    const pdf = doc.output('blob');\n\n    try {\n        const formData = new FormData();\n        formData.append('action', 'create_draft');\n        formData.append('file', pdf, `${draftName.value}.pdf`);\n        formData.append('file_data', JSON.stringify({\n            content: markdown.value,\n            filename: `${draftName.value}.pdf`\n        }));\n        console.log('formData:', formData);\n\n        const response = await axios.post(`${process.env.VUE_APP_FLASK_APP_URL}/project_workspace/${props.project_id}`, formData, {\n            headers: {\n                'Content-Type': 'multipart/form-data'\n            }\n        });\n\n        if (response.status === 200) {\n            console.log('Draft saved successfully');\n        } else {\n            console.log('Failed to save draft');\n        }\n    } catch (error) {\n        console.error('An error occurred while saving the draft:', error);\n    }\n};\n-->"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}